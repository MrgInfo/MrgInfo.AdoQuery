# https://docs.microsoft.com/en-us/azure/devops/pipelines/yaml-schema

name: $(Date:yyyyMMdd)$(Rev:.r)

trigger: none
#- master

pool:
  vmImage: ubuntu-latest

steps:
- task: Docker@2
  displayName: Login to ACR
  inputs:
    command: login
    containerRegistry: AzureContainers
- task: Docker@2
  displayName: Login to Docker Hub
  inputs:
    command: login
    containerRegistry: DockerHub
- task: Docker@2
  displayName: Build Oracle images
  inputs:
    command: buildAndPush
    containerRegistry: AzureContainers
    repository: ado-query/ora
    Dockerfile: '**/MrgInfo.AdoQuery.Oracle/Dockerfile'
    tags: |
        $(Build.BuildId)
        latest
- task: Docker@2
  displayName: Build SQL images
  inputs:
    command: buildAndPush
    containerRegistry: AzureContainers
    repository: ado-query/sql
    Dockerfile: '**/MrgInfo.AdoQuery.Oracle/Dockerfile'
    tags: |
        $(Build.BuildId)
        latest
